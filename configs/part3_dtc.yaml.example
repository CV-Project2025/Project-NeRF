# ==============================================================================
# Part 3: Dynamic NeRF (D-NeRF) - Direct Time Conditioning 模式
# 架构：直接拼接 [x, t] 编码 → MLP，无变形场，不使用 Instant-NGP
# ==============================================================================
mode: part3

# ==============================================================================
# 数据配置
# ==============================================================================
downscale: 2 # 图像下采样
white_bkgd: true # 白色背景
scene_scale: 1.0 # 场景缩放

# ==============================================================================
# 渲染配置
# ==============================================================================
near: 2.0 # 光线近裁剪面
far: 6.0 # 光线远裁剪面
n_samples: 128 # ⭐ 训练采样点数
render_n_samples: 128 # ⭐评估采样点数
batch_size: 4096 # ⭐ 训练批大小（比 Instant 小，因 MLP 更重）
chunk: 8192 # ⭐ 渲染分块

# ==============================================================================
# 训练配置
# ==============================================================================
train_iters: 50000 # ⭐ 训练总步数（MLP 收敛较慢，需更多步）
learning_rate: 0.0005 # 初始学习率（比 Instant 低）
weight_decay: 0.0001 # AdamW 权重衰减
eta_min: 0.00001 # Cosine LR 最小值
max_grad_norm: 1.0 # 梯度裁剪
use_amp: true # 混合精度训练

log_every: 100 # 训练日志频率
val_every: 1000 # 验证频率

# ==============================================================================
# 网络架构配置
# ==============================================================================
direct_time_conditioning: true # ⭐ 启用 Direct Time Conditioning 模式

L_embed: 10 # 空间位置编码频率（x, y, z）
L_embed_time: 6 # 时间编码频率（t ∈ [0,1]）
L_embed_dir: 4 # 视角方向编码频率（dx, dy, dz）

# MLP 解码器配置（标准 NeRF 结构）
hidden_dim: 256 # 隐藏层维度
num_layers: 8 # 网络深度
skip_layer: 4 # 跳连层位置
view_dim: 128 # 方向特征融合维度

canonical_type: nerf # ⭐ 必须为 nerf，不支持 instant

# ==============================================================================
# 输出与视频配置
# ==============================================================================
log_dir: "output/part3_direct" # ⭐ 独立输出目录，避免覆盖

# 视频渲染配置（--render_n -1 时生效）
video_frames: 300 # ⭐ 视频总帧数
n_rotations: 1.5 # ⭐ 相机旋转圈数
scene_center: [0.0, 0.0, 0.0] # ⭐ 场景中心
camera_height: 2.4 # ⭐ 相机高度
camera_radius: 3.0 # ⭐ 相机环绕半径